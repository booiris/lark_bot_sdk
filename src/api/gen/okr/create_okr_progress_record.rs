//! doc url: <https://open.larkoffice.com/document/uAjLw4CM/ukTMukTMukTM/reference/okr-v1/progress_record/create>
// Code generated by gen_api. DO NOT EDIT.

use serde::{Deserialize, Serialize};

use crate::api::BaseResp;
use crate::api::HasBaseResp;
use crate::core::model::{ApiRequest, CommonResponse, MethodOption, ReqParam, StreamReqParam};
use crate::{
    core::{http_client::HttpClient, store::Store},
    error::Error,
};

use crate::api::gen::okr::OkrService;

impl<'c, IStore: Store, IClient: HttpClient> OkrService<'c, IStore, IClient> {
    /// **api 版本: 2024-01-09T02:16:18+00:00**
    ///
    /// ## 创建 OKR 进展记录
    ///
    /// 创建 OKR 进展记录。
    ///

    ///
    /// doc: <https://open.larkoffice.com/document/uAjLw4CM/ukTMukTMukTM/reference/okr-v1/progress_record/create>
    ///
    /// new doc: <https://open.larkoffice.com/document/server-docs/okr-v1/progress_record/create>
    ///
    /// api url: <https://open.feishu.cn/document_portal/v1/document/get_detail?fullPath=%2Fserver-docs%2Fokr-v1%2Fprogress_record%2Fcreate>
    pub async fn create_okr_progress_record(
        &self,
        req: CreateOkrProgressRecordReq,
    ) -> Result<(CreateOkrProgressRecordResp, CommonResponse), Error> {
        self.create_okr_progress_record_with_opt(req, Default::default())
            .await
    }

    /// 参见 [create_okr_progress_record](#method.create_okr_progress_record) 函数
    pub async fn create_okr_progress_record_with_opt(
        &self,
        req: CreateOkrProgressRecordReq,
        method_option: MethodOption,
    ) -> Result<(CreateOkrProgressRecordResp, CommonResponse), Error> {
        #[cfg(feature = "test-util")]
        {
            if let Some(f) = self.mock().get_mock_create_okr_progress_record(&req) {
                tracing::info!("[lark] Okr#CreateOkrProgressRecord **mocking** api");
                return f(req);
            }
        }

        tracing::info!("[lark] Okr#CreateOkrProgressRecord call api");

        let req = ApiRequest {
            scope: "Okr",
            api: "CreateOkrProgressRecord",
            method: http::Method::POST,
            url: String::new()
                + self.cli.open_base_url.as_ref()
                + "/open-apis/okr/v1/progress_records",
            param_data: req.gen_param(),
            method_option,
            need_tenant_access_token: true,
            need_user_access_token: true,
            ..Default::default()
        };

        let (resp, common_resp): (CreateOkrProgressRecordRespInner, _) =
            self.cli.do_req(req).await?;
        let data = match resp.data {
            Some(data) => data,
            None => {
                return Err(Error::ErrResponse(
                    anyhow::anyhow!("missing response data"),
                    common_resp,
                ));
            }
        };
        Ok((data, common_resp))
    }
}

#[derive(Debug, Serialize, Deserialize, Clone, Default, lark_bot_sdk_macros::ApiReqParams)]
pub struct CreateOkrProgressRecordReq {
    /// 用户 ID 类型
    ///
    /// **示例值**: "open_id"
    ///
    /// **可选值**:
    ///
    /// `open_id`: 标识一个用户在某个应用中的身份。同一个用户在不同应用中的 Open ID 不同。[了解更多：如何获取 Open ID](https://open.feishu.cn/document/uAjLw4CM/ugTN1YjL4UTN24CO1UjN/trouble-shooting/how-to-obtain-openid)
    ///
    /// `union_id`: 标识一个用户在某个应用开发商下的身份。同一用户在同一开发商下的应用中的 Union ID 是相同的，在不同开发商下的应用中的 Union ID 是不同的。通过 Union ID，应用开发商可以把同个用户在多个应用中的身份关联起来。[了解更多：如何获取 Union ID？](https://open.feishu.cn/document/uAjLw4CM/ugTN1YjL4UTN24CO1UjN/trouble-shooting/how-to-obtain-union-id)
    ///
    /// `user_id`: 标识一个用户在某个租户内的身份。同一个用户在租户 A 和租户 B 内的 User ID 是不同的。在同一个租户内，一个用户的 User ID 在所有应用（包括商店应用）中都保持一致。User ID 主要用于在不同的应用间打通用户数据。[了解更多：如何获取 User ID？](https://open.feishu.cn/document/uAjLw4CM/ugTN1YjL4UTN24CO1UjN/trouble-shooting/how-to-obtain-user-id)
    #[api(
        kind = "query",
        name = "user_id_type",
        v_type = "var",
        option = "false"
    )]
    pub user_id_type: String,
    /// 进展来源
    ///
    /// **是否必填**: 是
    ///
    /// **示例值**: "周报系统"
    #[api(kind = "body", name = "source_title")]
    pub source_title: String,
    /// 进展来源链接
    ///
    /// **是否必填**: 是
    ///
    /// **示例值**: "https://www.zhoubao.com"
    #[api(kind = "body", name = "source_url")]
    pub source_url: String,
    /// 目标id，与target_type对应
    ///
    /// **是否必填**: 是
    ///
    /// **示例值**: "7041430377642082323"
    #[api(kind = "body", name = "target_id")]
    pub target_id: String,
    /// 目标类型
    ///
    /// **是否必填**: 是
    ///
    /// **示例值**: "1"
    ///
    /// **可选值**:
    ///
    /// `objective`: okr的O
    ///
    /// `key_result`: okr的KR
    #[api(kind = "body", name = "target_type")]
    pub target_type: i64,
    /// 进展详情 富文本格式
    ///
    /// **是否必填**: 是
    #[api(kind = "body", name = "content")]
    pub content: ContentBlockSubReq,
    /// pc进展来源链接
    ///
    /// **示例值**: "open.feishu.cn"
    #[api(kind = "body", name = "source_url_pc")]
    pub source_url_pc: Option<String>,
    /// mobile进展来源链接
    ///
    /// **示例值**: "open.feishu.cn"
    #[api(kind = "body", name = "source_url_mobile")]
    pub source_url_mobile: Option<String>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentBlockSubReq {
    /// 文档结构是按行排列的，每行内容是一个 Block
    #[serde(
        rename = "blocks",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub blocks: Vec<Option<ContentBlockElementSubReq>>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentBlockElementSubReq {
    /// 文档元素类型
    ///
    /// **示例值**: "paragraph"
    ///
    /// **可选值**:
    ///
    /// `paragraph`: 文本段落
    ///
    /// `gallery`: 图片
    #[serde(
        rename = "type",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub body_type: Option<String>,
    /// 文本段落
    #[serde(
        rename = "paragraph",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub paragraph: Option<ContentParagraphSubReq>,
    /// 图片
    #[serde(
        rename = "gallery",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub gallery: Option<ContentGallerySubReq>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentParagraphSubReq {
    /// 段落样式
    #[serde(
        rename = "style",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub style: Option<ContentParagraphStyleSubReq>,
    /// 段落元素组成一个段落
    #[serde(
        rename = "elements",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub elements: Vec<Option<ContentParagraphElementSubReq>>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentGallerySubReq {
    /// 图片元素
    #[serde(
        rename = "imageList",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub image_list: Vec<Option<ContentImageItemSubReq>>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentParagraphStyleSubReq {
    /// 有序列表/无序列表/任务列表
    #[serde(
        rename = "list",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub list: Option<ContentListSubReq>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentListSubReq {
    /// 列表类型
    ///
    /// **示例值**: "number"
    ///
    /// **可选值**:
    ///
    /// `number`: 有序列表
    ///
    /// `bullet`: 无序列表
    ///
    /// `checkBox`: 任务列表
    ///
    /// `checkedBox`: 已完成的任务列表
    ///
    /// `indent`: tab缩进
    #[serde(
        rename = "type",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub body_type: Option<String>,
    /// 列表的缩进级别，支持指定一行的缩进 除代码块以外的列表都支持设置缩进，支持 1-16 级缩进，取值范围：[1,16]
    ///
    /// **示例值**: "1"
    #[serde(
        rename = "indentLevel",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub indent_level: Option<i64>,
    /// 用于指定列表的行号，仅对有序列表和代码块生效 如果为有序列表设置了缩进，行号可能会显示为字母或者罗马数字
    ///
    /// **示例值**: "1"
    #[serde(
        rename = "number",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub number: Option<i64>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentParagraphElementSubReq {
    /// 元素类型
    ///
    /// **示例值**: "textRun"
    ///
    /// **可选值**:
    ///
    /// `textRun`: 文本型元素
    ///
    /// `docsLink`: 文档链接型元素
    ///
    /// `person`: 艾特用户型元素
    #[serde(
        rename = "type",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub body_type: Option<String>,
    /// 文本
    #[serde(
        rename = "textRun",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub text_run: Option<ContentTextRunSubReq>,
    /// 飞书云文档
    #[serde(
        rename = "docsLink",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub docs_link: Option<ContentDocsLinkSubReq>,
    /// 艾特用户
    #[serde(
        rename = "person",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub person: Option<ContentPersonSubReq>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentImageItemSubReq {
    /// 图片 token，通过上传图片接口获取
    ///
    /// **示例值**: "boxcnOj88GDkmWGm2zsTyCBqoLb"
    #[serde(
        rename = "fileToken",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub file_token: Option<String>,
    /// 图片链接
    ///
    /// **示例值**: "https://example.com/drive/home/"
    #[serde(
        rename = "src",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub src: Option<String>,
    /// 图片宽，单位px
    ///
    /// **示例值**: "458"
    #[serde(
        rename = "width",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub width: Option<f64>,
    /// 图片高，单位px
    ///
    /// **示例值**: "372"
    #[serde(
        rename = "height",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub height: Option<f64>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentTextRunSubReq {
    /// 具体的文本内容
    ///
    /// **示例值**: "周报内容"
    #[serde(
        rename = "text",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub text: Option<String>,
    /// 文本内容的样式，支持 BIUS、颜色等
    #[serde(
        rename = "style",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub style: Option<ContentTextStyleSubReq>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentDocsLinkSubReq {
    /// 飞书云文档链接地址
    ///
    /// **示例值**: "https://xxx.feishu.cn/docx/xxxxxxxx"
    #[serde(
        rename = "url",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub url: Option<String>,
    /// 飞书云文档标题
    ///
    /// **示例值**: "项目说明文档"
    #[serde(
        rename = "title",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub title: Option<String>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentPersonSubReq {
    /// 员工的OpenID
    ///
    /// **示例值**: "ou_3bbe8a09c20e89cce9bff989ed840674"
    #[serde(
        rename = "openId",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub open_id: Option<String>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentTextStyleSubReq {
    /// 是否加粗
    ///
    /// **示例值**: "true"
    #[serde(
        rename = "bold",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub bold: Option<bool>,
    /// 是否删除
    ///
    /// **示例值**: "true"
    #[serde(
        rename = "strikeThrough",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub strike_through: Option<bool>,
    /// 背景颜色
    #[serde(
        rename = "backColor",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub back_color: Option<ContentColorSubReq>,
    /// 字体颜色
    #[serde(
        rename = "textColor",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub text_color: Option<ContentColorSubReq>,
    /// 链接地址
    #[serde(
        rename = "link",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub link: Option<ContentLinkSubReq>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentColorSubReq {
    /// 红 取值范围[0,255]
    ///
    /// **示例值**: "216"
    #[serde(
        rename = "red",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub red: Option<i64>,
    /// 绿 取值范围[0,255]
    ///
    /// **示例值**: "191"
    #[serde(
        rename = "green",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub green: Option<i64>,
    /// 蓝 取值范围[0,255]
    ///
    /// **示例值**: "188"
    #[serde(
        rename = "blue",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub blue: Option<i64>,
    /// 透明度 取值范围[0,1]
    ///
    /// **示例值**: "0.1"
    #[serde(
        rename = "alpha",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub alpha: Option<f64>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentLinkSubReq {
    /// 链接地址
    ///
    /// **示例值**: "https://www.xxxxx.com/"
    #[serde(
        rename = "url",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub url: Option<String>,
}

#[derive(Debug, Serialize, Deserialize, Clone, lark_bot_sdk_macros::ApiBaseResp)]
struct CreateOkrProgressRecordRespInner {
    #[serde(flatten)]
    data: Option<CreateOkrProgressRecordResp>,
    #[serde(flatten)]
    base: BaseResp,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
pub struct CreateOkrProgressRecordResp {
    /// \-
    #[serde(
        rename = "data",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub data: ProgressRecordSubResp,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ProgressRecordSubResp {
    /// OKR 进展ID
    ///
    /// **示例值**: "7041469619902693396"
    #[serde(
        rename = "progress_id",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub progress_id: String,
    /// 进展更新时间 毫秒
    ///
    /// **示例值**: "1618500278663"
    #[serde(
        rename = "modify_time",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub modify_time: String,
    /// 进展 对应的 Content 详细内容
    #[serde(
        rename = "content",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub content: ContentBlockSubResp,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentBlockSubResp {
    /// 文档结构是按行排列的，每行内容是一个 Block
    #[serde(
        rename = "blocks",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub blocks: Vec<ContentBlockElementSubResp>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentBlockElementSubResp {
    /// 文档元素类型
    ///
    /// **示例值**: "paragraph"
    ///
    /// **可选值**:
    ///
    /// `paragraph`: 文本段落
    ///
    /// `gallery`: 图片
    #[serde(
        rename = "type",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub body_type: String,
    /// 文本段落
    #[serde(
        rename = "paragraph",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub paragraph: ContentParagraphSubResp,
    /// 图片
    #[serde(
        rename = "gallery",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub gallery: ContentGallerySubResp,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentParagraphSubResp {
    /// 段落样式
    #[serde(
        rename = "style",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub style: ContentParagraphStyleSubResp,
    /// 段落元素组成一个段落
    #[serde(
        rename = "elements",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub elements: Vec<ContentParagraphElementSubResp>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentGallerySubResp {
    /// 图片元素
    #[serde(
        rename = "imageList",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub image_list: Vec<ContentImageItemSubResp>,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentParagraphStyleSubResp {
    /// 有序列表/无序列表/任务列表
    #[serde(
        rename = "list",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub list: ContentListSubResp,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentListSubResp {
    /// 列表类型
    ///
    /// **示例值**: "number"
    ///
    /// **可选值**:
    ///
    /// `number`: 有序列表
    ///
    /// `bullet`: 无序列表
    ///
    /// `checkBox`: 任务列表
    ///
    /// `checkedBox`: 已完成的任务列表
    ///
    /// `indent`: tab缩进
    #[serde(
        rename = "type",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub body_type: String,
    /// 列表的缩进级别，支持指定一行的缩进 除代码块以外的列表都支持设置缩进，支持 1-16 级缩进，取值范围：[1,16]
    ///
    /// **示例值**: "1"
    #[serde(
        rename = "indentLevel",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub indent_level: i64,
    /// 用于指定列表的行号，仅对有序列表和代码块生效 如果为有序列表设置了缩进，行号可能会显示为字母或者罗马数字
    ///
    /// **示例值**: "1"
    #[serde(
        rename = "number",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub number: i64,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentParagraphElementSubResp {
    /// 元素类型
    ///
    /// **示例值**: "textRun"
    ///
    /// **可选值**:
    ///
    /// `textRun`: 文本型元素
    ///
    /// `docsLink`: 文档链接型元素
    ///
    /// `person`: 艾特用户型元素
    #[serde(
        rename = "type",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub body_type: String,
    /// 文本
    #[serde(
        rename = "textRun",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub text_run: ContentTextRunSubResp,
    /// 飞书云文档
    #[serde(
        rename = "docsLink",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub docs_link: ContentDocsLinkSubResp,
    /// 艾特用户
    #[serde(
        rename = "person",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub person: ContentPersonSubResp,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentImageItemSubResp {
    /// 图片 token，通过上传图片接口获取
    ///
    /// **示例值**: "boxcnOj88GDkmWGm2zsTyCBqoLb"
    #[serde(
        rename = "fileToken",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub file_token: String,
    /// 图片链接
    ///
    /// **示例值**: "https://example.cn/drive/home/"
    #[serde(
        rename = "src",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub src: String,
    /// 图片宽，单位px
    ///
    /// **示例值**: "458"
    #[serde(
        rename = "width",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub width: f64,
    /// 图片高，单位px
    ///
    /// **示例值**: "372"
    #[serde(
        rename = "height",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub height: f64,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentTextRunSubResp {
    /// 具体的文本内容
    ///
    /// **示例值**: "周报内容"
    #[serde(
        rename = "text",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub text: String,
    /// 文本内容的样式，支持 BIUS、颜色等
    #[serde(
        rename = "style",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub style: ContentTextStyleSubResp,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentDocsLinkSubResp {
    /// 飞书云文档链接地址
    ///
    /// **示例值**: "https://xxx.feishu.cn/docx/xxxxxxxx"
    #[serde(
        rename = "url",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub url: String,
    /// 飞书云文档标题
    ///
    /// **示例值**: "项目说明文档"
    #[serde(
        rename = "title",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub title: String,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentPersonSubResp {
    /// 员工的OpenID
    ///
    /// **示例值**: "ou_3bbe8a09c20e89cce9bff989ed840674"
    #[serde(
        rename = "openId",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub open_id: String,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentTextStyleSubResp {
    /// 是否加粗
    ///
    /// **示例值**: "true"
    #[serde(
        rename = "bold",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub bold: bool,
    /// 是否删除
    ///
    /// **示例值**: "true"
    #[serde(
        rename = "strikeThrough",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub strike_through: bool,
    /// 背景颜色
    #[serde(
        rename = "backColor",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub back_color: ContentColorSubResp,
    /// 字体颜色
    #[serde(
        rename = "textColor",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub text_color: ContentColorSubResp,
    /// 链接地址
    #[serde(
        rename = "link",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub link: ContentLinkSubResp,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentColorSubResp {
    /// 红 取值范围[0,255]
    ///
    /// **示例值**: "216"
    #[serde(
        rename = "red",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub red: i64,
    /// 绿 取值范围[0,255]
    ///
    /// **示例值**: "191"
    #[serde(
        rename = "green",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub green: i64,
    /// 蓝 取值范围[0,255]
    ///
    /// **示例值**: "188"
    #[serde(
        rename = "blue",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub blue: i64,
    /// 透明度 取值范围[0,1]
    ///
    /// **示例值**: "0.1"
    #[serde(
        rename = "alpha",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub alpha: f64,
}

#[derive(Debug, Serialize, Deserialize, Clone, Default)]
#[serde(default)]
pub struct ContentLinkSubResp {
    /// 链接地址
    ///
    /// **示例值**: "https://www.xxxxx.com/"
    #[serde(
        rename = "url",
        deserialize_with = "crate::utils::serde_helper::null_to_default"
    )]
    pub url: String,
}

#[cfg(feature = "test-util")]
mod test_utils {
    use std::sync::Arc;

    use self::gen::okr::OkrServiceMocker;
    use crate::core::mocker::*;

    use super::*;
    use crate::api::*;
    use crate::core::model::*;

    pub struct Mocker;

    pub trait MockFunc:
        Fn(
            CreateOkrProgressRecordReq,
        ) -> Result<(CreateOkrProgressRecordResp, CommonResponse), Error>
        + Send
        + Sync
        + 'static
    {
    }
    impl<
            T: Fn(
                    CreateOkrProgressRecordReq,
                ) -> Result<(CreateOkrProgressRecordResp, CommonResponse), Error>
                + Send
                + Sync
                + 'static,
        > MockFunc for T
    {
    }

    impl<'c, IStore: Store, IClient: HttpClient> OkrServiceMocker<'c, IStore, IClient> {
        pub fn mock_create_okr_progress_record<F: MockFunc>(
            &self,
            f: F,
        ) -> MockerBuilder<
            Mocker,
            CreateOkrProgressRecordReq,
            CreateOkrProgressRecordResp,
            Arc<dyn MockFunc>,
        > {
            MockerBuilder::new(self.cli.instance_id, Arc::new(f))
        }

        pub(super) fn get_mock_create_okr_progress_record(
            &self,
            req: &CreateOkrProgressRecordReq,
        ) -> Option<Arc<dyn MockFunc>> {
            do_mock::<
                Mocker,
                CreateOkrProgressRecordReq,
                CreateOkrProgressRecordResp,
                Arc<dyn MockFunc>,
            >(self.cli.instance_id, req)
        }
    }
}

#[cfg(feature = "test-util")]
#[cfg(test)]
mod test {
    use crate::{
        api::gen::okr::create_okr_progress_record::{
            CreateOkrProgressRecordReq, CreateOkrProgressRecordResp,
            CreateOkrProgressRecordRespInner,
        },
        core::{model::CommonResponse, Lark},
    };

    #[tokio::test]
    async fn test_mock() {
        let lark = Lark::new("".to_owned(), "".into());
        let mocker = lark
            .okr()
            .mock()
            .mock_create_okr_progress_record(|_| {
                Ok((
                    CreateOkrProgressRecordResp::default(),
                    CommonResponse::default(),
                ))
            })
            .build();
        let res = lark
            .okr()
            .create_okr_progress_record(CreateOkrProgressRecordReq::default())
            .await;
        assert!(res.is_ok());
        mocker.clear();
        let res = lark
            .okr()
            .create_okr_progress_record(CreateOkrProgressRecordReq::default())
            .await;
        assert!(res.is_err());
    }

    const REQ: &str = r#"{
    "source_title":"测试周报系统",
    "source_url":"https://www.baidu.com/",
    "target_id":"7043693679567028244",
    "target_type":2,
    "content":{
        "blocks":[
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"粗体验证",
                                "style":{
                                    "bold":true
                                }
                            }
                        }
                    ]
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"*",
                                "style":{
                                    "bold":true
                                }
                            }
                        },
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"删除线验证",
                                "style":{
                                    "strikeThrough":true
                                }
                            }
                        }
                    ]
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"字体颜色验证",
                                "style":{
                                    "textColor":{
                                        "red":216,
                                        "green":57,
                                        "blue":49,
                                        "alpha":1
                                    }
                                }
                            }
                        }
                    ]
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"背景颜色验证",
                                "style":{
                                    "backColor":{
                                        "red":251,
                                        "green":191,
                                        "blue":188,
                                        "alpha":1
                                    }
                                }
                            }
                        }
                    ]
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"粗体+删除+字体颜色+背景颜色验证",
                                "style":{
                                    "bold":true,
                                    "strikeThrough":true,
                                    "backColor":{
                                        "red":251,
                                        "green":191,
                                        "blue":188,
                                        "alpha":1
                                    },
                                    "textColor":{
                                        "red":216,
                                        "green":57,
                                        "blue":49,
                                        "alpha":1
                                    }
                                }
                            }
                        }
                    ]
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"有序标题1验证，",
                                "style":{

                                }
                            }
                        },
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"粗体验证",
                                "style":{
                                    "bold":true
                                }
                            }
                        }
                    ],
                    "style":{
                        "list":{
                            "type":"number",
                            "indentLevel":1,
                            "number":1
                        }
                    }
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"有序标题2验证，",
                                "style":{

                                }
                            }
                        },
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"删除线验证",
                                "style":{
                                    "strikeThrough":true
                                }
                            }
                        }
                    ],
                    "style":{
                        "list":{
                            "type":"number",
                            "indentLevel":1,
                            "number":2
                        }
                    }
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"有序标题3验证，",
                                "style":{

                                }
                            }
                        },
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"字体背景颜色验证",
                                "style":{
                                    "backColor":{
                                        "red":251,
                                        "green":191,
                                        "blue":188,
                                        "alpha":1
                                    },
                                    "textColor":{
                                        "red":216,
                                        "green":57,
                                        "blue":49,
                                        "alpha":1
                                    }
                                }
                            }
                        }
                    ],
                    "style":{
                        "list":{
                            "type":"number",
                            "indentLevel":1,
                            "number":3
                        }
                    }
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"无序标题1验证，",
                                "style":{

                                }
                            }
                        },
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"粗体",
                                "style":{
                                    "bold":true
                                }
                            }
                        }
                    ],
                    "style":{
                        "list":{
                            "type":"bullet",
                            "indentLevel":1
                        }
                    }
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"无序标题2验证，",
                                "style":{

                                }
                            }
                        },
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"删除线",
                                "style":{
                                    "strikeThrough":true
                                }
                            }
                        }
                    ],
                    "style":{
                        "list":{
                            "type":"bullet",
                            "indentLevel":1
                        }
                    }
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"无序标题3验证，",
                                "style":{

                                }
                            }
                        },
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"字体背景颜色验证",
                                "style":{
                                    "backColor":{
                                        "red":251,
                                        "green":191,
                                        "blue":188,
                                        "alpha":1
                                    },
                                    "textColor":{
                                        "red":216,
                                        "green":57,
                                        "blue":49,
                                        "alpha":1
                                    }
                                }
                            }
                        }
                    ],
                    "style":{
                        "list":{
                            "type":"bullet",
                            "indentLevel":1
                        }
                    }
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"https://example.cn/docx/doxcnO2Wkq0YPZQYLuJKyyOvLrh#doxcnSOui82swqk6c0o436Ak3nc",
                                "style":{
                                    "link":{
                                        "url":"https://example.cn/docx/doxcnO2Wkq0YPZQYLuJKyyOvLrh#doxcnSOui82swqk6c0o436Ak3nc"
                                    }
                                }
                            }
                        }
                    ]
                }
            },
            {
                "type":"gallery",
                "gallery":{
                    "imageList":[
                        {
                            "src":"https://internal-api-okr.feishu-boe.cn/stream/api/downloadFile/?file_token=boxbcMTBQO9ofLjWkDuPxkxOA2c&ticket=eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJ0YXJnZXRfaWQiOiI3MDQxNDMwMzc3NjQyMDgyMzIzIiwidGFyZ2V0X3R5cGUiOjMsImFjdGlvbiI6MiwiZmlsZV90b2tlbiI6ImJveGJjTVRCUU85b2ZMaldrRHVQeGt4T0EyYyIsInVzZXJfaWQiOiI2OTY5ODU1NTAxNzQ0ODM0MDkyIiwidGVuYW50X2lkIjoiNjg3NzUwMjY4NzYwOTQwNjk5MCIsImV4cCI6MTY0MDE1NTk2M30.yc4qV2pkGUVwSO53-N_XGgeMucjmDn9iso1Ez_8vpghFz8YdeSDf4NHQpxOHYHc8RURvwI0a5UTNKKJ9CWagTQ",
                            "fileToken":"boxbcMTBQO9ofLjWkDuPxkxOA2c",
                            "width":458,
                            "height":372
                        }
                    ]
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"任务列表未勾选验证",
                                "style":{

                                }
                            }
                        }
                    ],
                    "style":{
                        "list":{
                            "type":"checkBox",
                            "indentLevel":1
                        }
                    }
                }
            },
            {
                "type":"paragraph",
                "paragraph":{
                    "elements":[
                        {
                            "type":"textRun",
                            "textRun":{
                                "text":"任务列表已勾选验证",
                                "style":{

                                }
                            }
                        }
                    ],
                    "style":{
                        "list":{
                            "type":"checkedBox",
                            "indentLevel":1
                        }
                    }
                }
            }
        ]
    }
}"#;

    #[test]
    fn test_req() {
        if REQ == "{}" {
            return;
        }
        if let Err(e) = serde_json::from_str::<super::CreateOkrProgressRecordReqBody>(REQ) {
            panic!("{}", e);
        }
    }

    const RESP: &str = r#"{
    "code": 0,
    "data": {
        "content": {
            "blocks": [
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {
                                        "bold": true
                                    },
                                    "text": "粗体验证"
                                },
                                "type": "textRun"
                            }
                        ]
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {
                                        "bold": true
                                    },
                                    "text": "*"
                                },
                                "type": "textRun"
                            },
                            {
                                "textRun": {
                                    "style": {
                                        "strikeThrough": true
                                    },
                                    "text": "删除线验证"
                                },
                                "type": "textRun"
                            }
                        ]
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {
                                        "textColor": {
                                            "alpha": 1,
                                            "blue": 49,
                                            "green": 57,
                                            "red": 216
                                        }
                                    },
                                    "text": "字体颜色验证"
                                },
                                "type": "textRun"
                            }
                        ]
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {
                                        "backColor": {
                                            "alpha": 1,
                                            "blue": 188,
                                            "green": 191,
                                            "red": 251
                                        }
                                    },
                                    "text": "背景颜色验证"
                                },
                                "type": "textRun"
                            }
                        ]
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {
                                        "backColor": {
                                            "alpha": 1,
                                            "blue": 188,
                                            "green": 191,
                                            "red": 251
                                        },
                                        "bold": true,
                                        "strikeThrough": true,
                                        "textColor": {
                                            "alpha": 1,
                                            "blue": 49,
                                            "green": 57,
                                            "red": 216
                                        }
                                    },
                                    "text": "粗体+删除+字体颜色+背景颜色验证"
                                },
                                "type": "textRun"
                            }
                        ]
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {},
                                    "text": "有序标题1验证，"
                                },
                                "type": "textRun"
                            },
                            {
                                "textRun": {
                                    "style": {
                                        "bold": true
                                    },
                                    "text": "粗体验证"
                                },
                                "type": "textRun"
                            }
                        ],
                        "style": {
                            "list": {
                                "indentLevel": 1,
                                "number": 1,
                                "type": "number"
                            }
                        }
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {},
                                    "text": "有序标题2验证，"
                                },
                                "type": "textRun"
                            },
                            {
                                "textRun": {
                                    "style": {
                                        "strikeThrough": true
                                    },
                                    "text": "删除线验证"
                                },
                                "type": "textRun"
                            }
                        ],
                        "style": {
                            "list": {
                                "indentLevel": 1,
                                "number": 2,
                                "type": "number"
                            }
                        }
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {},
                                    "text": "有序标题3验证，"
                                },
                                "type": "textRun"
                            },
                            {
                                "textRun": {
                                    "style": {
                                        "backColor": {
                                            "alpha": 1,
                                            "blue": 188,
                                            "green": 191,
                                            "red": 251
                                        },
                                        "textColor": {
                                            "alpha": 1,
                                            "blue": 49,
                                            "green": 57,
                                            "red": 216
                                        }
                                    },
                                    "text": "字体背景颜色验证"
                                },
                                "type": "textRun"
                            }
                        ],
                        "style": {
                            "list": {
                                "indentLevel": 1,
                                "number": 3,
                                "type": "number"
                            }
                        }
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {},
                                    "text": "无序标题1验证，"
                                },
                                "type": "textRun"
                            },
                            {
                                "textRun": {
                                    "style": {
                                        "bold": true
                                    },
                                    "text": "粗体"
                                },
                                "type": "textRun"
                            }
                        ],
                        "style": {
                            "list": {
                                "indentLevel": 1,
                                "type": "bullet"
                            }
                        }
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {},
                                    "text": "无序标题2验证，"
                                },
                                "type": "textRun"
                            },
                            {
                                "textRun": {
                                    "style": {
                                        "strikeThrough": true
                                    },
                                    "text": "删除线"
                                },
                                "type": "textRun"
                            }
                        ],
                        "style": {
                            "list": {
                                "indentLevel": 1,
                                "type": "bullet"
                            }
                        }
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {},
                                    "text": "无序标题3验证，"
                                },
                                "type": "textRun"
                            },
                            {
                                "textRun": {
                                    "style": {
                                        "backColor": {
                                            "alpha": 1,
                                            "blue": 188,
                                            "green": 191,
                                            "red": 251
                                        },
                                        "textColor": {
                                            "alpha": 1,
                                            "blue": 49,
                                            "green": 57,
                                            "red": 216
                                        }
                                    },
                                    "text": "字体背景颜色验证"
                                },
                                "type": "textRun"
                            }
                        ],
                        "style": {
                            "list": {
                                "indentLevel": 1,
                                "type": "bullet"
                            }
                        }
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {
                                        "link": {
                                            "url": "https://example.cn/docx/doxcnO2Wkq0YPZQYLuJKyyOvLrh#doxcnSOui82swqk6c0o436Ak3nc"
                                        }
                                    },
                                    "text": "https://example.cn/docx/doxcnO2Wkq0YPZQYLuJKyyOvLrh#doxcnSOui82swqk6c0o436Ak3nc"
                                },
                                "type": "textRun"
                            }
                        ]
                    },
                    "type": "paragraph"
                },
                {
                    "gallery": {
                        "imageList": [
                            {
                                "fileToken": "boxbcMTBQO9ofLjWkDuPxkxOA2c",
                                "height": 372,
                                "src": "https://internal-api-okr.feishu-boe.cn/stream/api/downloadFile/?file_token=boxbcMTBQO9ofLjWkDuPxkxOA2c&ticket=eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJ0YXJnZXRfaWQiOiI3MDQxNDMwMzc3NjQyMDgyMzIzIiwidGFyZ2V0X3R5cGUiOjMsImFjdGlvbiI6MiwiZmlsZV90b2tlbiI6ImJveGJjTVRCUU85b2ZMaldrRHVQeGt4T0EyYyIsInVzZXJfaWQiOiI2OTY5ODU1NTAxNzQ0ODM0MDkyIiwidGVuYW50X2lkIjoiNjg3NzUwMjY4NzYwOTQwNjk5MCIsImV4cCI6MTY0MDE1NTk2M30.yc4qV2pkGUVwSO53-N_XGgeMucjmDn9iso1Ez_8vpghFz8YdeSDf4NHQpxOHYHc8RURvwI0a5UTNKKJ9CWagTQ",
                                "width": 458
                            }
                        ]
                    },
                    "type": "gallery"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {},
                                    "text": "任务列表未勾选验证"
                                },
                                "type": "textRun"
                            }
                        ],
                        "style": {
                            "list": {
                                "indentLevel": 1,
                                "type": "checkBox"
                            }
                        }
                    },
                    "type": "paragraph"
                },
                {
                    "paragraph": {
                        "elements": [
                            {
                                "textRun": {
                                    "style": {},
                                    "text": "任务列表已勾选验证"
                                },
                                "type": "textRun"
                            }
                        ],
                        "style": {
                            "list": {
                                "indentLevel": 1,
                                "type": "checkedBox"
                            }
                        }
                    },
                    "type": "paragraph"
                }
            ]
        },
        "modify_time": "1640675837810",
        "progress_id": "7046317985098760212"
    },
    "msg": "success"
}"#;
    #[test]
    fn test_resp() {
        let res = serde_json::from_str::<CreateOkrProgressRecordRespInner>(RESP);
        if let Err(e) = res {
            panic!("{}", e);
        }
        if let Ok(v) = serde_json::from_str::<serde_json::Value>(RESP) {
            if v.get("data").is_some() {
                assert!(res.unwrap().data.is_some());
            }
        }
    }
}
